{
  "name": "profile-and-music-stress",
  "bug": "White screen crash on iPad Safari — suspect UI popups (profile, WMP) trigger tab kill",
  "description": "Stress-test open-profile and toggle-music-menu with jittered timing. Each attempt: skip to PLAYING, then rapid toggle cycles of both UI panels with survive windows to catch hard reloads.",
  "target": "https://192.168.1.150:8081/?test=1&debug=1&low=0",
  "maxAttempts": 20,
  "attemptTimeout": 120000,
  "seed": 42,
  "steps": [
    { "log": "── Skip to PLAYING ──" },
    { "cmd": "skip-to-play", "delay": 1000 },
    { "wait": "PLAYING", "timeout": 10000 },
    { "assert": "alive", "eq": true },
    { "survive": 2000 },

    { "log": "── Cycle 1: toggle-music-menu (open + close) ──" },
    { "cmd": "toggle-music-menu", "delay": 800 },
    { "survive": 1500 },
    { "cmd": "toggle-music-menu", "delay": 600 },
    { "survive": 1000 },

    { "log": "── Cycle 2: open-profile (open + close) ──" },
    { "cmd": "open-profile", "delay": 700 },
    { "survive": 1500 },
    { "cmd": "close-profile", "delay": 500 },
    { "survive": 1000 },

    { "log": "── Cycle 3: rapid WMP toggle x3 ──" },
    { "cmd": "toggle-music-menu", "delay": 300 },
    { "cmd": "toggle-music-menu", "delay": 300 },
    { "cmd": "toggle-music-menu", "delay": 300 },
    { "survive": 2000 },
    { "cmd": "toggle-music-menu", "delay": 400 },

    { "log": "── Cycle 4: interleave profile + WMP ──" },
    { "cmd": "open-profile", "delay": 500 },
    { "cmd": "toggle-music-menu", "delay": 400 },
    { "survive": 1500 },
    { "cmd": "close-profile", "delay": 300 },
    { "cmd": "toggle-music-menu", "delay": 500 },
    { "survive": 1000 },

    { "log": "── Cycle 5: burst WMP open/close x5 ──" },
    { "cmd": "toggle-music-menu", "repeat": 5, "interval": 200, "delay": 300 },
    { "survive": 2000 },

    { "log": "── Cycle 6: burst profile open/close x3 ──" },
    { "cmd": "open-profile", "delay": 200 },
    { "cmd": "close-profile", "delay": 200 },
    { "cmd": "open-profile", "delay": 200 },
    { "cmd": "close-profile", "delay": 200 },
    { "cmd": "open-profile", "delay": 200 },
    { "cmd": "close-profile", "delay": 300 },
    { "survive": 2000 },

    { "log": "── Cycle 7: WMP toggle with lane changes ──" },
    { "cmd": { "type": "move-y", "y": 300 }, "delay": 200 },
    { "cmd": "toggle-music-menu", "delay": 500 },
    { "cmd": { "type": "move-y", "y": 700 }, "delay": 200 },
    { "cmd": "toggle-music-menu", "delay": 500 },
    { "cmd": { "type": "move-y", "y": 450 }, "delay": 200 },
    { "survive": 2000 },

    { "log": "── Cycle 8: profile during speed-tap ──" },
    { "cmd": "speed-tap", "delay": 100 },
    { "cmd": "open-profile", "delay": 300 },
    { "cmd": "speed-tap", "delay": 100 },
    { "cmd": "speed-tap", "delay": 100 },
    { "cmd": "close-profile", "delay": 400 },
    { "survive": 2000 },

    { "log": "── Cycle 9: simultaneous both panels ──" },
    { "cmd": "toggle-music-menu", "delay": 100 },
    { "cmd": "open-profile", "delay": 100 },
    { "survive": 1500 },
    { "cmd": "close-profile", "delay": 100 },
    { "cmd": "toggle-music-menu", "delay": 100 },
    { "survive": 1500 },

    { "log": "── Cycle 10: extended survive with WMP open ──" },
    { "cmd": "toggle-music-menu", "delay": 500 },
    { "survive": 5000 },
    { "cmd": "toggle-music-menu", "delay": 300 },
    { "survive": 3000 },

    { "log": "── Final check ──" },
    { "assert": "alive", "eq": true }
  ]
}
